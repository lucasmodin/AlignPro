<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <title>PM Dashboard</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="stylesheet" href="/styles/dashboardstyle.css">
<!--
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        h2 {
            margin-top: 20px;
        }
    </style>
-->
</head>
<body>
<header th:replace="~{header-footer/layout-header-loggedin :: header}"></header>
<main>

    <section class="filter">
    <h1>PM Dashboard</h1>
    <form method="get" th:action="@{/pm-dashboard/filter}">
        <label for="filter">Choose a filter:</label>
        <select id="filter" name="filterProjects" required>
            <option value="">Select Filter</option>
            <option th:each="filter : ${filterList}" th:value="${filter}" th:text="${filter}"></option>
        </select>
        <button type="submit">Apply Filter</button>
    </form>
    </section>

    <section class="pm-containers">
    <h2>Projects</h2>
    <table>
        <thead>
        <tr>
            <th>Project Name</th>
            <th>Description</th>
            <th>Start Date</th>
            <th>Deadline</th>
            <th>Total Sum Time</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="project : ${data.getProjectList()}">
            <td class="headings" th:text="${project.getProjectName()}"></td>
            <td class="description" th:text="${project.projectDescription}"></td>
            <td class="dates" th:text="${project.getStartDate()}"></td>
            <td class="dates" th:text="${project.getDeadLine()}"></td>
            <td class="time" th:text="${project.getTotalTime()}"></td>
            <!--<td><a th:href="@{../projects/edit-project/{projectID}(projectID=${project.projectID})}">Edit</a></td>
            <td><form th:action="@{../projects/delete-project/{projectID}(projectID=${project.projectID})}" method="post">
                <button type="submit">Delete</button>
            </form></td>
            <td><a th:href="@{../subProjects/createSubProject/{projectID}(projectID=${project.projectID})}">Add Sub-Project</a> </td>
        --></tr>
        </tbody>
    </table>
    <!--<a th:href="@{../projects/CreateProject}">Add Project</a>-->
    </section>

    <!-- Table for SubProjects -->
    <section class="pm-containers">
    <h2>SubProjects</h2>
    <div>
        <button type="button" onclick="toggleVisibility('SubProjects')">
            Toggle SubTask Table
        </button>
    </div>
    <table id="SubProjects">
        <thead>
        <tr>
            <th>SubProject Name</th>
            <th>Description</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Sum Time</th>
            <th>Belongs to Project</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="subProject : ${data.getSubProjectList()}">
            <td class="headings" th:text="${subProject.getSubProjectName()}"></td>
            <td class="description" th:text="${subProject.getSubProjectDescription()}"></td>
            <td class="dates" th:text="${subProject.getStartDate()}"></td>
            <td class="dates" th:text="${subProject.getEndDate()}"></td>
            <td class="time" th:text="${subProject.getSumTime()}"></td>
            <td class="belongTo" th:text="${subProject.getFilter()}"></td>
            <!--<td><a th:href="@{../subProjects/edit-subproject/{subProjectID}(subProjectID=${subProject.subProjectID})}">Edit</a></td>
            <td><form th:action="@{../subProjects/deleteSubProject/{subProjectID}(subProjectID=${subProject.subProjectID})}" method="post">
                <button type="submit">Delete</button>
            </form></td>
            <td><a th:href="@{../tasks/createTask/{subProjectID}(subProjectID=${subProject.subProjectID})}">Add Task</a></td>
        --></tr>
        </tbody>
    </table>
    </section>

    <!-- Table for Tasks -->
    <section class="pm-containers">
    <h2>Tasks</h2>
    <div>
        <button type="button" onclick="toggleVisibility('TaskTable')">
            Toggle SubTask Table
        </button>
    </div>
    <table id="TaskTable">
        <thead>
        <tr>
            <th>Task Name</th>
            <th>Description</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Estimated Time</th>
            <th>Belongs to Sub-Project</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="task : ${data.getTaskList()}">
            <td class="headings" th:text="${task.getTaskName()}"></td>
            <td class="description" th:text="${task.getTaskDescription()}"></td>
            <td class="dates" th:text="${task.getStartDate()}"></td>
            <td class="dates" th:text="${task.getEndDate()}"></td>
            <td class="time" th:text="${task.getEstimatedTime()}"></td>
            <td class="belongTo" th:text="${task.getFilter()}"></td>
            <!--<td><a th:href="@{../tasks/edit-task/{taskID}(taskID=${task.taskID})}">Edit</a></td>
            <td><form th:action="@{../tasks/deleteTask/{taskID}(taskID=${task.taskID})}" method="post">
                <button type="submit">Delete</button>
            </form></td>
            <td><a th:href="@{../subTasks/createSubTask/{taskID}(taskID=${task.taskID})}">Add Sub-Task</a> </td>
        --></tr>
        </tbody>
    </table>
    </section>
    <!-- Table for SubTasks -->

    <section class="pm-containers">
    <h2>SubTasks</h2>
    <div>
        <button type="button" onclick="toggleVisibility('subTaskTable')">
            Toggle SubTask Table
        </button>
    </div>
    <table>
        <thead>
        <tr>
            <th>SubTask Name</th>
            <th>Description</th>
            <th>Start Date</th>
            <th>End Date</th>
            <th>Estimated Time</th>
            <th>Belongs to Task</th>
        </tr>
        </thead>
        <tbody>
        <tr th:each="subTask : ${data.getSubTaskList()}">
            <td class="headings" th:text="${subTask.getSubTaskName()}"></td>
            <td class="description" th:text="${subTask.getSubTaskDescription()}"></td>
            <td class="dates" th:text="${subTask.getStartDate()}"></td>
            <td class="dates" th:text="${subTask.getEndDate()}"></td>
            <td class="time" th:text="${subTask.getTime()}"></td>
            <td class="belongTo" th:text="${subTask.getFilter()}"></td>
            <!--<td><a th:href="@{../subTasks/edit-subTask/{subTaskID}(subTaskID=${subTask.subTaskID})}">Edit</a></td>
            <td><form th:action="@{../subTasks/deleteSubTask/{subTaskID}(subTaskID=${subTask.subTaskID})}" method="post">
                <button type="submit">Delete</button>
            </form></td>
        --></tr>
        </tbody>
    </table>
    </section>

</main>
<footer th:replace="~{header-footer/layout-footer :: footer}"></footer>
<script>
    function toggleVisibility(tableId) {
        const table = document.getElementById(tableId);
        if (table.style.display === "none" || table.style.display === "") {
            table.style.display = "table";
        } else {
            table.style.display = "none";
        }
    }
</script>
</body>
</html>